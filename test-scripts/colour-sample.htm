<!DOCTYPE html>
<html>
<head>
<title>Peckham Sentiment</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
<meta name="viewport" content="width = device-width, initial-scale = 1.0 ,  minimum-scale = 1.0,  maximum-scale=1.0">

<link href="base.css" type="text/css" rel="stylesheet"/>
</head>
<body>


<script type="text/javascript" src="colour-theif.js"></script>
<script type="text/javascript">

// create canvas
var canvas; 

// canvas context
var context;

// size of body
var body_size = {};

// colour theif
var colour_thief;

var images = [
	
	{
		"x" : 300,
		"y" : 120,
		"asset" : "../samples/franks.jpg",
		"inner_radius" : 5,
		"outer_radius" : 70,
		"radius" : 60
	},
	{
		"x" : 100,
		"y" : 100,
		"asset" : "../samples/bar-story.jpg",
		"inner_radius" : 5,
		"outer_radius" : 70,
		"radius" : 60
	}
]

// start
document.addEventListener("DOMContentLoaded", function() {
      
    // Add and get the canvas context
	canvas = document.createElement("canvas");
	document.body.appendChild(canvas);
	context = canvas.getContext('2d');
	
	// boom!
	sizing();
	
	//init color theif
	colour_thief = new ColorThief();
	
	// Load in an image and sample it
	for(var a = 0, length = images.length; a<length; a++) {
		
		var image = new Image();
		var item = images[a];
		
			image.addEventListener("load", function(evt){
				
			create_gradient(item.x,item.y,item.inner_radius, item.outer_radius, item.radius, image);
			
			});
			
			image.setAttribute("src",item.asset);
	}
});

function create_gradient(x,y,inner_radius, outer_radius, radius, asset) {

	var colour_palette = colour_thief.getPalette(asset);
			
	// Create gradients
	var gradient = context.createRadialGradient(x, y, inner_radius, x, y, outer_radius);
	 
	for(var a = 0, length = colour_palette.length;  a < 3; a++) {
		var step = parseFloat(a*0.1).toFixed(1);
		if(a===0) step = 0;
		//gradient.addColorStop(step, 'rgb('+colour_palette[a].toString()+')');
		gradient.addColorStop(a*0.3, 'rgb('+colour_palette[a].toString()+')');
	}
	 
	gradient.addColorStop(1, 'rgba(0,0,0,0)');
	
	context.arc(x, y, radius, 0, 2 * Math.PI);

	// draw shapes
	context.fillStyle = gradient;
	context.fill();
}

function sizing() {
	body_size = document.body.getBoundingClientRect();
	canvas.width = body_size.width;
	canvas.height = body_size.height;	
}


 
	


</script>

</body>
</html>